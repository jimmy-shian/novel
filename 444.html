<!DOCTYPE html>
<html>
  <head>
    <style>
      .board {
        background-color: yellow;
        border: solid 1px black;
        display: flex;
        flex-wrap: wrap;
        width: 300px;
        height: 300px;
      }
      .cell {
        background-color: white;
        border: solid 1px black;
        color: black;
        display: flex;
        font-size: 48px;
        font-weight: bold;
        justify-content: center;
        align-items: center;
        width: 100px;
        height: 100px;
        box-sizing: border-box;
      }
      .warning {
        color: red;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="board">
      <div class="cell" id="cell-0"></div>
      <div class="cell" id="cell-1"></div>
      <div class="cell" id="cell-2"></div>
      <div class="cell" id="cell-3"></div>
      <div class="cell" id="cell-4"></div>
      <div class="cell" id="cell-5"></div>
      <div class="cell" id="cell-6"></div>
      <div class="cell" id="cell-7"></div>
      <div class="cell" id="cell-8"></div>
    </div>
    <div class="warning" id="warning"></div>
    <div id="message"></div>
    <button id="reset-button">重置</button>
    <div id="time">遊戲時間：0 秒</div>
    <div id="turns">遊戲次數：0 次</div>

    <script>
        let currentPlayer = "O";
        let gameBoard = ["", "", "", "", "", "", "", "", ""];
        let gameActive = true;
        let turns = 0;
        let startTime;
        let timeInterval;
      
        const cells = document.querySelectorAll(".cell");
        const warning = document.getElementById("warning");
        const message = document.getElementById("message");
        const resetButton = document.getElementById("reset-button");
        const timeDisplay = document.getElementById("time");
        const turnsDisplay = document.getElementById("turns");
      
        cells.forEach((cell, index) => {
          cell.addEventListener("click", handleClick);
        });
      
        resetButton.addEventListener("click", resetGame);
      
        function handleClick(event) {
          const cell = event.target;
          const cellIndex = parseInt(cell.id.split("-")[1]);
          if (!gameBoard[cellIndex] && gameActive) {
            gameBoard[cellIndex] = currentPlayer;
            cell.textContent = currentPlayer;
            turns++;
            checkWin();
            switchPlayer();
          } else if (!gameActive) {
            warning.textContent = "遊戲已結束，請重新開始！";
          } else {
            warning.textContent = "不可以下在同一個位置！";
          }
        }
      
        function checkWin() {
          const winConditions = [
            [0, 1, 2],
            [3, 4, 5],
            [6, 7, 8],
            [0, 3, 6],
            [1, 4, 7],
            [2, 5, 8],
            [0, 4, 8],
            [2, 4, 6],
          ];
      
          for (let i = 0; i < winConditions.length; i++) {
            const [a, b, c] = winConditions[i];
            if (
              gameBoard[a] &&
              gameBoard[a] === gameBoard[b] &&
              gameBoard[a] === gameBoard[c]
            ) {
              gameActive = false;
              clearInterval(timeInterval);
              message.textContent = currentPlayer + " 獲勝！";
              return;
            }
          }
      
          if (turns === 9) {
            gameActive = false;
            clearInterval(timeInterval);
            message.textContent = "平局！";
          }
        }
      
        function switchPlayer() {
          currentPlayer = currentPlayer === "O" ? "X" : "O";
        }
      
        function resetGame() {
            gameActive = true;
            turns = 0;
            currentPlayer = "O";
            gameBoard = ["", "", "", "", "", "", "", "", ""];
            cells.forEach((cell) => {
            cell.innerText = "";
            });
            warning.innerText = "";
            message.innerText = "";
            time.innerText = "遊戲時間：0 秒";
            turnsElement.innerText = "遊戲次數：0 次";
            startTime = null;
            clearInterval(timer);
            }
            
            // add event listener to the reset button to reset the game
            resetButton.addEventListener("click", resetGame);
            
            // start the game
            resetGame();
            })();      
        </script>

    </body>
    </html>
